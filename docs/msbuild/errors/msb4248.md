---
title: "MSB4248 diagnostic code"
description: "Cannot expand metadata in expression 'value'."
ms.date: 1/15/2025
ms.topic: "error-reference"
f1_keywords:
 - MSB4248
 - MSBuild.CannotExpandItemMetadata
dev_langs:
  - "VB"
  - "CSharp"
  - "C++"
  - "FSharp"
author: ghogen
ms.author: ghogen
manager: mijacobs
ms.subservice: msbuild
---

# MSB4248 diagnostic code

<!-- :::ErrorDefinitionDescription::: -->
<!-- :::editable-content name="introDescription"::: -->
This article describes the MSB4248 error code.
<!-- :::editable-content-end::: -->

## Message text

```output
MSB4248: Cannot expand metadata in expression 'value'.
```

<!-- :::editable-content name="postOutputDescription"::: -->
<!--
{StrBegin="MSB4248: "}UE: This message is shown when metadata cannot be expanded in an expression for some reason e.g. trying to apply
    %(RootDir) to an item-spec that's not a valid path would result in this error.
    LOCALIZATION: "{1}" is a localized message explaining the problem.
-->

### Context in Which the Error is Logged

The error code MSB4248 is generated in scenarios where MSBuild attempts to evaluate or expand item metadata but fails due to invalid or inaccessible metadata references. This typically occurs during the evaluation phase of a build process when metadata is used in expressions or as part of task parameters.

The metadata expansion process in MSBuild involves resolving placeholders like `%(MetadataName)` from items in the project file. If the metadata being referenced does not exist for the item or cannot be resolved due to structural issues in the project file, the error is triggered.

### Possible Causes of the Error

1. **Nonexistent Metadata Reference**:
   The most common cause is referencing metadata that does not exist for the item. For example, if a project item does not define a specific metadata property, attempting to access it will result in the error.

2. **Invalid Item or Metadata Context**:
   If the metadata is referenced outside of a valid item context (e.g., in a place where item metadata is not applicable), MSBuild cannot resolve it.

3. **Syntax Errors in Metadata References**:
   Incorrect syntax, such as missing `%` symbols or braces, in metadata expressions can cause the expansion to fail.

4. **Empty or Null Items**:
   If the item list being evaluated is empty or null, attempts to expand metadata for those items will fail.

5. **Misconfigured Targets or Tasks**:
   If tasks or targets attempt to use metadata that has not been defined or initialized properly, the error can occur during task execution.

### Suggested Resolutions or Workarounds

1. **Validate Metadata References**:
   Ensure that all metadata references in the project file are valid and correspond to metadata that exists for the items being processed. Use tools or verbosity options to inspect item definitions and metadata.

2. **Provide Default Metadata Values**:
   Where appropriate, define default values for metadata in case they are not explicitly set for certain items. This can be done using `<Metadata>` elements in item definitions.

3. **Scope Metadata References Correctly**:
   Confirm that metadata references are used within the correct scope. Avoid referencing item metadata outside of item groups, targets, or tasks that process those items.

4. **Check Item Definitions**:
   Verify that the items being evaluated are properly initialized and contain the metadata you intend to reference. If the item list is empty, consider adding conditions to validate its existence before expanding metadata.

5. **Debug with Diagnostic Logging**:
   Enable diagnostic logging in MSBuild to trace the metadata evaluation process. This can help identify which metadata reference is causing the error and the context in which it is failing.

6. **Review Task Parameter Usage**:
   If the error occurs within a task, inspect the task parameters to ensure that metadata is being passed correctly. Avoid hardcoding metadata references in task parameters without verifying their existence.

7. **Correct Syntax Errors**:
   Double-check the syntax for metadata references. Ensure that `%` symbols and braces are used correctly, and avoid typos or formatting issues.

8. **Fallback Logic for Missing Metadata**:
   Implement fallback logic to handle cases where metadata might not exist. For example, use conditions or property functions to substitute default values when expanding metadata.

<!-- :::editable-content-end::: -->
<!-- :::ErrorDefinitionDescription-end::: -->

## Applies to

All versions of MSBuild
