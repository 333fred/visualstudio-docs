---
title: "MSB3249 diagnostic code"
description: "Application Configuration file 'value' is invalid."
ms.date: 12/06/2024
ms.topic: "error-reference"
f1_keywords:
 - MSB3249
 - MSBuild.ResolveAssemblyReference.InvalidAppConfig
dev_langs:
  - "VB"
  - "CSharp"
  - "C++"
  - "FSharp"
author: ghogen
ms.author: ghogen
manager: mijacobs
ms.subservice: msbuild
---

# MSB3249 diagnostic code

<!-- :::ErrorDefinitionDescription::: -->
<!-- :::editable-content name="introDescription"::: -->
This article describes the MSB3249 error code.
<!-- :::editable-content-end::: -->

## Message text

```output
MSB3249: Application Configuration file 'value' is invalid.
```

<!-- :::editable-content name="postOutputDescription"::: -->

## Analysis of MSB3249

The error code MSB3249 typically indicates an issue with an application configuration file (app.config) during the resolution of assembly references in MSBuild. Below are the occurrences and details:

### Instance #1: Reading and Validating `app.config`

#### **Context**
This error is generated when MSBuild attempts to read or parse the `app.config` file associated with a project. If the configuration file is malformed or unreadable, the process of resolving assembly references fails.

- **Location in Source Code**: The error is logged in the `ResolveAssemblyReference` task, specifically in the logic that handles app.config parsing.
- **Key Functionality**: MSBuild uses the `System.Configuration` namespace or similar logic to load and validate the app.config file. If the file does not conform to XML schema or contains invalid elements, the error is triggered.

#### **Possible Cause**
1. The `app.config` file is missing or not found in the expected location.
2. The file is malformed, containing invalid XML (e.g., mismatched tags or encoding issues).
3. Unsupported or invalid configuration elements are present in the file.
4. File permissions prevent MSBuild from accessing the file.

#### **Resolution/Workarounds**
1. **Validate the app.config File**:
   - Open the `app.config` file in an XML editor or IDE to check for syntax errors or malformed XML.
   - Use a schema validator to ensure compliance with the configuration schema.

2. **Ensure File Accessibility**:
   - Verify that the `app.config` file exists at the expected path (e.g., in the project directory).
   - Check file permissions to ensure MSBuild has read access to the file.

3. **Check for Unsupported Configurations**:
   - Review the elements in the `app.config` file to ensure they are supported by the target .NET framework or runtime.

4. **Fallback Mechanism**:
   - If the app.config is not critical for the build, consider excluding it temporarily to verify if the build succeeds without it.

### Instance #2: Resolving Assembly Binding Redirects

#### **Context**
Another scenario where MSB3249 is triggered is during the resolution of assembly binding redirects specified in the `app.config` file. MSBuild uses this information to determine correct assembly versions during the build process.

- **Location in Source Code**: This error occurs when MSBuild processes the runtime assembly binding section (`<runtime><assemblyBinding>`) of the `app.config` file.
- **Key Functionality**: MSBuild relies on correct XML structure and valid assembly binding configuration to resolve assemblies properly.

#### **Possible Cause**
1. Invalid assembly binding redirects, such as:
   - Incorrect or unsupported version ranges.
   - Missing required attributes like `name`, `publicKeyToken`, or `culture`.
2. Duplicated or conflicting entries in the `<assemblyBinding>` section.
3. Misconfiguration of dependent assemblies that do not match the project's target framework/runtime.

#### **Resolution/Workarounds**
1. **Validate Assembly Binding Entries**:
   - Ensure all `<dependentAssembly>` entries are correctly formatted with required attributes.
   - Verify that the specified assembly versions exist and are compatible with the project.

2. **Check for Duplicates or Conflicts**:
   - Remove or consolidate duplicate `<dependentAssembly>` entries.
   - Resolve conflicts by ensuring that only one set of binding redirects is applied per assembly.

3. **Update Target Framework**:
   - Ensure the project's target framework matches the assemblies referenced in the `app.config` file.
   - If necessary, update the project to a compatible framework.

4. **Use MSBuild Debugging Options**:
   - Run MSBuild with diagnostic verbosity (`/v:diag`) to pinpoint the exact issue with the binding redirects.

### Instance #3: App.Config File in Multi-Project Builds

#### **Context**
In solutions with multiple projects, MSBuild may encounter issues when trying to merge or process multiple `app.config` files. If one of the files is invalid, the entire build process may fail with the MSB3249 error.

- **Location in Source Code**: This generally occurs during the `ResolveAssemblyReference` task where MSBuild attempts to unify or process configurations from multiple projects.
- **Key Functionality**: MSBuild may attempt to merge `app.config` files or resolve conflicts in scenarios like shared builds or project dependencies.

#### **Possible Cause**
1. Conflicts between `app.config` files from different projects in the solution.
2. One or more `app.config` files are invalid or contain incompatible configurations.
3. Improper handling of shared configurations or missing files in dependent projects.

#### **Resolution/Workarounds**
1. **Verify All App.Config Files**:
   - Check the validity of `app.config` files for every project in the solution.
   - Ensure they are properly formatted and compatible with their respective projects.

2. **Consolidate App.Config Files**:
   - For shared configurations, create a single valid `app.config` file and reference it in all dependent projects.
   - Use tools like `Microsoft.Build.Utilities` to handle configuration merging programmatically if necessary.

3. **Adjust Build Order**:
   - Ensure dependent projects are built in the correct order so their configurations are resolved before the main project.

4. **Use NuGet Package Management**:
   - If conflicts arise from NuGet package dependencies, ensure that all packages are updated and compatible with the target frameworks.

## General Insights and Recommendations

1. **Enable MSBuild Logging**:
   - Use `/fileLogger` or `/consoleLogger` options to capture detailed logs that can help identify the root cause of the error.

2. **Test with Simplified Projects**:
   - Isolate the problematic project or configuration file and test it independently to narrow down the issue.

3. **Check MSBuild Version**:
   - Ensure you are using a compatible MSBuild version for the project's target framework and runtime. Mismatched versions may result in configuration issues.

4. **Automate Configuration Validation**:
   - Use tools like `fxcop` or custom MSBuild tasks to validate `app.config` files as part of the build pipeline.

By addressing these scenarios, developers can resolve or mitigate the MSB3249 error effectively within MSBuild.
<!-- :::editable-content-end::: -->
<!-- :::ErrorDefinitionDescription-end::: -->

## Applies to

All versions of MSBuild
